<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <title>Tic Tac Toe</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <style>
        /*
            make html element into 100% height "flex" element so we can more
            easily center the board & title
        */
        html {
            display: flex;
            height: 100%;
            justify-content: center;
            align-items: center;
            font-family: Helvetica, Arial, sans-serif;
        }
        
        /*
            The title for our game
        */
        .title {
            text-align: center;
            margin: -15px 0 35px 0;
            font-size: 30px;
        }
        
        /*
            Board will hold a grid of divs, "table" is an easy way to manage a
            grid
        */
        .board {
            display: table;
            table-layout: fixed;
        }
        
        /*
            a "cell" in our game is a single square
        */
        .board-cell {
            display: table-cell;
            border: 1px solid darkgray;
            height: 100px;
            width: 100px;
            text-align: center;
            line-height: 100px;
            font-size: 60px;
            font-weight: bold;
        }
        
        /*
            Remove the top border from all cells in the first row
        */
        .board-row:first-child .board-cell {
            border-top: 0;
        }
        
        /*
            Remove the bottom border from all cells in the last row
        */
        .board-row:last-child .board-cell {
            border-bottom: 0;
        }
        
        /*
            Remove the left border from all first cells in each row
        */
        .board-row .board-cell:first-child {
            border-left: 0;
        }
        
        /*
            Remove the right border from all last cells in each row
        */
        .board-row .board-cell:last-child {
            border-right: 0;
        }
    </style>
    <script>
        var turnNumber = 0; // even number turns are X's; odd number turns are O's
        
        function valueAt(row, column) {
            return $(".board-cell").eq(3*row + column).html();
        }
        
        function setValueAt(row, column, player) {
            $(".board-cell").eq(3*row + column).html(player);
        }
    
        // clickHandler receives the position of the square which was clicked
        function clickHandler(pos) {
            // check if square is empty
            if (valueAt(pos.row, pos.column) != "") {
                alert("Hey, this square is already taken");
                // stop here so player can choose again
                return;
            }
            if (turnNumber % 2 == 0) {
                setValueAt(pos.row, pos.column, "X");
            } else {
                setValueAt(pos.row, pos.column, "O");
            }
            
            // check if there's a winner yet
            var w = winner();
            if (w == "X" || w == "O") {
                alert(w + " wins!");
                return;
            }
            
            // if no winner, check if board is full, if so declare a draw
            if (turnNumber == 8) {
                alert("Draw!");
                return;
            }
            // advance the turn counter to switch between X and O
            turnNumber++;
        }
        
        // winner determines if there's a winner on the board, if so it returns who the winner is
        function winner() {
            if (checkforWin("X")) {
                return "X";
            }
            if (checkforWin("O")) {
                return "O";
            }
        }
        
        function checkforWin(player) {
            // check each row
            for (var row = 0; row < 3; row++) {
                if (checkforWinRow(player, row)) {
                    return true;
                }
            }
            
            // check each column
            for (var column = 0; column < 3; column++) {
                if (checkforWinColumn(player, column)) {
                    return true;
                }
            }
            
            // check each diagonal
            if (checkforWinDiagonalLeft(player)) {
                return true;
            }
            if (checkforWinDiagonalRight(player)) {
                return true;
            }
            
            return false;
        }
        
        // checkforWinRow checks if player provided has won the row provided
        function checkforWinRow(player, row) {
            for (var column = 0; column < 3; column++) {
                if (valueAt(row, column) != player) {
                    return false;
                }
            }
            return true;
        }
        
        // checkforWinColumn checks if player provided has won the column provided
        function checkforWinColumn(player, column) {
            for (var row = 0; row < 3; row++) {
                if (valueAt(row, column) != player) {
                    return false;
                }
            }
            return true;
        }
        
        // checkforWinDiagonalLeft checks if player provided has won the "left" diagonal
        function checkforWinDiagonalLeft(player) {
            for (var i = 0; i < 3; i++) {
                if (valueAt(i, i) != player) {
                    return false;
                }
            }
            return true;
        }
        
        // checkforWinDiagonalRight checks if player provided has won the "right" diagonal
        function checkforWinDiagonalRight(player) {
            for (var i = 0; i < 3; i++) {
                if (valueAt(i, 2-i) != player) {
                    return false;
                }
            }
            return true;
        }
        
        /*
            $(document).ready() waits until the page is ready to be modified
        */
        $(document).ready(function() {
            var numRows = 3;
            var numColumns = 3;
        
            // use two for loops to add all the divs needed for the board
            for (var i = 0; i < numRows; i++) {
                // each row begins with a <div class="board-row">
                var $row = $("<div class='board-row'></div>");
                
                for (var j = 0; j < numColumns; j++) {
                    // add a cell to the new row
                    var $cell = $("<div class='board-cell'></div>");
                    // add a click handler for this cell, and pass it data
                    // about which cell it is
                    $cell.on("click", { row: i, column: j }, function(event) {
                        clickHandler(event.data);
                    });
                    $row.append($cell);
                }
                
                $(".board").append($row);
            }
        });
    </script>
</head>

<body>
    <div class="title">Tic Tac Toe</div>

    <div class="board"></div>
</body>

</html>
